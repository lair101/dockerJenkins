<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<!--
		(c) Copyright IBM Corporation 2015. All rights reserved.
		All Rights Reserved * Licensed Materials - Property of IBM 
	-->

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="abstract" content="Overview of the Patient Identifier Cross-reference Manager pattern"/>
	<link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
	<title>Healthcare: Patient Identifier Cross-reference Manager pattern</title>
	<script language="JavaScript" src="../help/actions.js" type="text/javascript"></script>
</head>
<body role="main">
<h1 class="topictitle1"><span>Healthcare: Patient Identifier Cross-reference Manager</span> pattern</h1>
<div>
	<p class="shortdesc">Use the <span>Healthcare: Patient Identifier Cross-reference Manager</span> pattern
	with IBM&reg; InfoSphere&reg; Master Data Management (MDM) to create a Patient Identifier Cross-reference Manager that 
	you can use with the Integrating the Healthcare Enterprise (IHE) Patient Identifier Cross Referencing (PIX) profile. 
	You can then integrate your clinical applications with the pattern, to act as Patient Identity Source and 
	Patient Identifier Cross-reference Consumer actors, as defined in the PIX profile.</p>
</div>
<div class="section">
	<h2 class="sectiontitle">Solution</h2>
	<p>You can use the <span>Healthcare: Patient Identifier Cross-reference Manager</span> pattern to create an integration
	solution that receives ADT or QBP HL7 messages over MLLP from a clinical application (the Patient Identity Source in the PIX profile). 
	The integration solution then returns an appropriate acknowledgment to the clinical application, as specified by the PIX
	profile (transaction ITI-8 for ADT messages, or transaction ITI-9 for QBP messages). 
	If the message is valid then the integration solution uses SOAP request/response messages to update or retrieve information from the 
	enterprise master patient index (EMPI) as specified by the content of the message. The EMPI runs in IBM InfoSphere MDM.</p>
	<p>The behavior of the integration solution depends on the type of the incoming message. For ADT messages, the integration solution completes the following 
	tasks:
	<ul>
		<li>If the incoming message is an ADT message of type A01, A04, or A05, the patient details contained in the message are added to the EMPI as 
	a new record. You cannot add a patient if an existing patient with those details already exists.</li>
		<li>If the incoming message is an ADT message of type A08, the patient details contained in the message are used to update an existing record 
	in the EMPI. You can update a patient only if an existing patient with those details already exists.</li>
		<li>All other ADT message types result in an AR (application reject) ACK.</li>
		<li>For successful updates, an AA (application accept) ACK is sent after a success response is received from the EMPI.</li>
		<li>For unsuccessful updates, an AE (application error) or AR (application reject) ACK is sent. You can see additional information about the error in the 
			ERR.3.HL7ErrorCode field of the ACK, which contains the HL7 error code. The error codes are defined by <span>HL7 Table 0357</span>. 
			If there is a SOAP fault associated with the error, you can see more information about the error in the ERR.7.DiagnosticInformation field.</li>
	</ul></p>
	<p>For QBP messages, the integration solution completes the following tasks:
	<ul>
		<li>If the incoming message is a QBP message of type Q23, the integration solution retrieves a list of IDs and domains from the EMPI for the patient 
			that is specified in the incoming message. The list of of IDs and domains is returned in an RSP (response) message.</li>
		<li>For successful queries, an AA RSP (response) message of type K23 is returned. This message contains the list of IDs and domains for the patient that is 
			specified in the incoming message.</li>
		<li>For unsuccessful queries, an AE RSP, AE ACK, or AR ACK message is returned, depending on the reason for the failure. Additional information about the 
			failure is contained in the ERR segment of the response.</li>
	</ul>
	</p>
	<p>When you generate an instance of the <span>Healthcare: Patient Identifier Cross-reference Manager</span> 
	pattern, a library named <span class="msobjpropval">IHEHL7DFDLLibrary</span> is created 
	automatically. The library contains a DFDL version 2.5.1 model, which is used to define the HL7 
	messages that are used by the pattern.</p>
	
	<h3>Acknowledgments</h3>
	<p>The following tables describe the values in the acknowledgment (ACK) messages that are returned by the pattern. ACK messages are returned by the pattern in 
	response to ADT messages and in response to QBP messages if there is an error because the EMPI server was not contacted.</p>
	<div class="tablenoborder">
		<h4>MSH</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						acknowledgment message</th>
					<th class="invisible" valign="top" width="34%">If not present
						in the input message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.1.FieldSeparator</th>
					<td valign="top" width="*" class="invisible">MSH.1.FieldSeparator
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '|' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.2.ServiceString</th>
					<td valign="top" width="*" class="invisible">MSH.2.ServiceString
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '^~\&amp;' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.3.SendingApplication</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Application</span> pattern parameter, in the <span class="uicontrol">PIX Manager</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.4.SendingFacility</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Facility</span> pattern parameter, in the <span class="uicontrol">PIX Manager</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.5.ReceivingApplication</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Application</span> pattern parameter, in the <span class="uicontrol">Patient Identity Source</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.6.ReceivingFacility</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Facility</span> pattern parameter, in the <span class="uicontrol">Patient Identity Source</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.7.DateTimeOfMessage</th>
					<td valign="top" width="*" class="invisible">Current date time
						in the format <span class="msobjprop"> YYYYMMddHHmmss </span></td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.9.MessageType</th>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval">'ACK^ACK^ACK'</span></td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.10.MessageControlID</th>
					<td valign="top" width="*" class="invisible">New unique
						identifier</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.11.ProcessingID</th>
					<td valign="top" width="*" class="invisible">MSH.11.ProcessingID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> 'P' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.12.VersionID</th>
					<td valign="top" width="*" class="invisible">MSH.12.VersionID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '2.5' </span></td>
				</tr>
			</tbody>
		</table>
		<h4>MSA</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						acknowledgment message</th>
					<th class="invisible" valign="top" width="34%">If not present
						in the input message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSA.1.AcknowledgmentCode</th>
					<td valign="top" width="*" class="invisible">On successful
						receipt of the message, the MSA acknowledgment code is set to <span
						class="msobjpropval">AA</span>. Otherwise, the MSA acknowledgment code is set to 
						<span class="msobjpropval">AR</span> or <span class="msobjpropval">AE</span>, depending on the error.</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSA.2.MessageControlID</th>
					<td valign="top" width="*" class="invisible">MSH.10.MessageControlID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '123456789' </span></td>
				</tr>
			</tbody>
		</table>
		<h4>ERR</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						acknowledgment message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.2.ErrorLocation</th>
					<td valign="top" width="*" class="invisible">The HL7 message field that contains the error</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.3.HL7ErrorCode</th>
					<td valign="top" width="*" class="invisible">The HL7 (communication) error code</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.4.Severity</th>
					<td valign="top" width="*" class="invisible">The severity of an application error</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.7.DiagnosticInformation</th>
					<td valign="top" width="*" class="invisible">Additional error information for SOAP faults</td>
				</tr>
			</tbody>
		</table>
	</div>
<h3>Responses</h3>
	<p>The following tables describe the values in the response (RSP) messages that are returned by the pattern. RSP messages are returned by the pattern in 
	response to QBP messages.</p>
	<div class="tablenoborder">
		<h4>MSH</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						response message</th>
					<th class="invisible" valign="top" width="34%">If not present
						in the input message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.1.FieldSeparator</th>
					<td valign="top" width="*" class="invisible">MSH.1.FieldSeparator
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '|' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.2.ServiceString</th>
					<td valign="top" width="*" class="invisible">MSH.2.ServiceString
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '^~\&amp;' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.3.SendingApplication</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Application</span> pattern parameter, in the <span class="uicontrol">PIX Manager</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.4.SendingFacility</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Facility</span> pattern parameter, in the <span class="uicontrol">PIX Manager</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.5.ReceivingApplication</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Application</span> pattern parameter, in the <span class="uicontrol">Patient Identity Source</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.6.ReceivingFacility</th>
					<td valign="top" width="*" class="invisible">The value that is specified by the <span
						class="msobjprop">Facility</span> pattern parameter, in the <span class="uicontrol">Patient Identity Source</span> 
						pattern parameters group</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.7.DateTimeOfMessage</th>
					<td valign="top" width="*" class="invisible">Current date time
						in the format <span class="msobjprop"> YYYYMMddHHmmss </span></td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.9.MessageType</th>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval">'RSP^K23^RSP_K23'</span></td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.10.MessageControlID</th>
					<td valign="top" width="*" class="invisible">New unique
						identifier</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.11.ProcessingID</th>
					<td valign="top" width="*" class="invisible">MSH.11.ProcessingID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> 'P' </span></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSH.12.VersionID</th>
					<td valign="top" width="*" class="invisible">MSH.12.VersionID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '2.5' </span></td>
				</tr>
			</tbody>
		</table>
		<h4>MSA</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						response message</th>
					<th class="invisible" valign="top" width="34%">If not present
						in the input message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSA.1.AcknowledgmentCode</th>
					<td valign="top" width="*" class="invisible">On a successful
						query, the MSA acknowledgment code is set to <span
						class="msobjpropval">AA</span>. Otherwise, the MSA acknowledgment code is set to 
						<span class="msobjpropval">AR</span> or <span class="msobjpropval">AE</span>, depending on the error.</td>
					<td valign="top" width="*" class="invisible"></td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">MSA.2.MessageControlID</th>
					<td valign="top" width="*" class="invisible">MSH.10.MessageControlID
						from the input message</td>
					<td valign="top" width="*" class="invisible"><span
						class="msobjpropval"> '123456789' </span></td>
				</tr>
			</tbody>
		</table>
		<h4>ERR</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						response message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.2.ErrorLocation</th>
					<td valign="top" width="*" class="invisible">The HL7 message field that contains the error</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.3.HL7ErrorCode</th>
					<td valign="top" width="*" class="invisible">The HL7 (communication) error code</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.4.Severity</th>
					<td valign="top" width="*" class="invisible">The severity of an application error</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">ERR.7.DiagnosticInformation</th>
					<td valign="top" width="*" class="invisible">Additional error information for SOAP faults</td>
				</tr>
			</tbody>
		</table>
		<h4>QAK</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						response message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">QAK.1</th>
					<td valign="top" width="*" class="invisible">The query tag</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">QAK.2</th>
					<td valign="top" width="*" class="invisible">The query response status:
					<ul>
						<li><span class="msobjpropval">OK</span> if data is found and there are no errors</li>
						<li><span class="msobjpropval">NF</span> if no data is found and there are no errors</li>
						<li><span class="msobjpropval">AE</span> if the patient ID or domain specified in the input message is not recognized</li>
					</ul></td>
				</tr>
			</tbody>
		</table>
		<h4>QPD</h4>
		<p>This segment is a copy of the QPD segment that was provided in the incoming QBP message.</p>
		<h4>PID</h4>
		<table summary="" width="100%" border="1" cellpadding="4"
			cellspacing="0" frame="border" rules="all">
			<thead align="left">
				<tr>
					<th class="firstcol" align="left" valign="top" width="33%">Field
						name</th>
					<th class="invisible" valign="top" width="33%">Field value in
						response message</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">PID.3.PatientIdentifierList</th>
					<td valign="top" width="*" class="invisible">The unique identifier for the patient. If the patient is in multiple domains, one copy of 
					 this field is present for each domain and each copy contains the identifier for a domain.</td>
				</tr>
				<tr>
					<th align="left" valign="top" width="*" class="firstcol">PID.5.PatientName</th>
					<td valign="top" width="*" class="invisible">The patient name. There are two copies of this field. The first copy is empty and the second 
					 contains only the value <span class="msobjpropval">S</span> in component seven of the field.</td>
				</tr>
			</tbody>
		</table>
	</div>
	<h3>Providing a fully qualified assigning authority in response messages</h3>
	<p>A fully qualified assigning authority is the combination of namespace ID, universal ID, and universal ID type. By default, in response (RSP) messages, 
	the PID 3 field contains only the namespace ID, in field PID.3.4.1. If you require your integration solution to provide a fully qualified assigning 
	authority, you can create a configurable service that will add the universal ID to field PID.3.4.2 and the universal ID type to field PID.3.4.3.</p>
	
	<p>The configurable service contains a list of namespace IDs, together with the associated universal IDs and universal ID types for each namespace ID. When the 
	integration solution is running, the PID.3.4.1 field in RSP messages is checked against the list of namespace IDs in the configurable service. 
	If field PID.3.4.1 matches a namespace ID in the configurable service, the associated universal ID is added to field PID.3.4.2 and 
	the associated universal ID type is added to field 3.4.3 of the RSP message. You can update and redeploy the configurable service to update the list while the 
	integration solution is running.</p>
	
	<p>To use a configurable service to provide a fully qualified assigning authority, complete the following steps:
	<ol> 
		<li>Create a new configurable service; see "Creating configurable services" in the IBM Integration Bus documentation. 
			The configurable service must meet the following requirements: 
			<ul>
				<li>The name of the configurable service must be <span class="filepath">AssigningAuthority</span>.</li>
				<li>The configurable service must be of type <span class="msobjprop">UserDefined</span>.</li>
				<li>For each namespace ID that you want to define, add a property to the configurable service, where the name of the property is the same as the 
					namespace ID. For example, if you want to use a namespace ID <span class="msobjpropval">MH</span>, add a property called 
					<span class="msobjpropval">MH</span>.</li>
				<li>For each namespace ID that you define, add a value <span class="msobjpropval"><var>ID</var>&amp;<var>ID_type</var></span> to the corresponding 
					configurable service property, where <var>ID</var> is the universal ID for the namespace ID and <var>ID_type</var> is the universal ID type for 
					the namespace ID. For example, if for namespace ID <span class="msobjpropval">MH</span> the universal ID is <span class="msobjpropval">1.23</span> 
					and the universal ID type is <span class="msobjpropval">ISO</span>, add the value <span class="msobjpropval">1.23&amp;ISO</span> to 
					the configurable service property <span class="msobjpropval">MH</span>.</li>
			</ul>
		</li>
		<li>Deploy the configurable service to the same integration node that you deploy your <span>Healthcare: Patient Identifier Cross-reference Manager</span> 
			integration solution to.</li>
	</ol>
	</p>
</div>
<div>
	<div class="familylinks">
		<a name="anchorBack"></a>
		<div class="section">
			<h2 class="sectiontitle">Related tasks</h2>
		</div>
		<p>
			Read the following section for information about how to apply and use this pattern.
		</p>
		<div>
			<a href="constraints.htm" title="Constraints on the use of the pattern">
			Constraints on the use of the pattern</a>
		</div>
		<div>
			<a href="before.htm" title="Tasks to complete before using the pattern">
			Tasks to complete before applying the pattern</a>
		</div>
<!--	<div>
		<a href="apply.htm" title="Apply the pattern and configure parameters">
			Apply and configure the pattern</a>
	</div>
-->
		<div>
			<a href="parameters.htm" title="Parameters for the pattern">
			Parameters for the pattern</a>
		</div>
<!--	
	<div>
		<a href="after.htm" title="Tasks to complete after generating the pattern">
			Tasks to complete after generating the pattern</a>
	</div>
-->
</div>
</div>
</body>
</html>
