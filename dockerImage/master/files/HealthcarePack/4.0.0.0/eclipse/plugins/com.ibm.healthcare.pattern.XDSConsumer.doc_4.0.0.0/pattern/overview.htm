<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
        <title>Healthcare: Cross-Enterprise Document Sharing Consumer pattern</title>
    </head>
    <body>
        <h1 class="topictitle1">Healthcare: Cross-Enterprise Document Sharing Consumer pattern</h1>
        <div>
            <p class="shortdesc">Use the Healthcare: Cross-Enterprise Document Sharing Consumer pattern to help you to create an integration solution 
            that complies with the Integrating the Healthcare Enterprise (IHE) Cross-Enterprise Document Sharing (XDS) profile. Cross-Enterprise Document Sharing 
            allows the sharing of documents through a document registry and a document repository. Patient documents are stored in the document repository. 
            The document registry stores document metadata, including UUIDs and patient identifiers. You can use the pattern to find 
            universal unique identifiers (UUIDs) for documents from your document registry and then retrieve the associated documents from your document repository.</p>

        </div>
        
        
        <div class="section">
            <h2 class="sectiontitle">Solution</h2>
        </div>
		<p>The <span>Healthcare: Cross-Enterprise Document Sharing Consumer</span> pattern contains two flows, the <span class="filepath">FindDocuments</span> 
        flow and the <span class="filepath">RetrieveDocumentSet</span> flow. You must provide the HTTP or HTTPS endpoint of your document registry as a pattern parameter. 
        You must also provide the local directories for input and output files for each flow.</p>
		<p>
		Use the <span class="filepath">FindDocuments</span> flow to query the document registry for document UUIDs:
        <ul>
            <li>The flow input is a Binary Large Object (BLOB) in a text file in the form of the PID segment from HL7, for example: 
                <span class="filepath">0bd58f55ed06424^^^&amp;1.3.6.1.4.1.21367.2009.1.2.300&amp;ISO</span>.</li>
            <li>The flow output is in the following XML form: 
                <span class="filepath">&lt;Document>&lt;uniqueId>1.42.20140903083332.2&lt;/uniqueId>&lt;repositoryUniqueId>1.19.6.24.109.42.1.5&lt;/repositoryUniqueId>&lt;/Document></span> 
                and outputs one file in the specified directory for each document retrieved.</li>
        </ul>
		</p>		
		<p>
		Use the <span class="filepath">RetrieveDocumentSet</span> flow to retrieve documents:
        <ul>
            <li>The flow input is in the following XML form: <span class="filepath">&lt;Document>&lt;uniqueId>1.42.20140903083332.2&lt;/uniqueId>&lt;repositoryUniqueId>1.19.6.24.109.42.1.5&lt;/repositoryUniqueId>&lt;/Document></span></li>
            <li>The flow output is in the binary form of the retrieved document. One binary file is saved in the specified directory for each file retrieved.</li>
        </ul>    
        </p>	
		
        <p>
		Because the output from the <span class="filepath">FindDocuments</span> flow is the same as the input required for the 
        <span class="filepath">RetrieveDocumentSet</span>, the two flows can be used together to identify and retrieve all files related to specific patient IDs. 
        To use the two flows together, set the output directory of the <span class="filepath">FindDocuments</span> flow to be the same as the input directory of the 
        <span class="filepath">RetrieveDocumentSet</span> flow.
		</p>
		<div class="familylinks">
			<a name="anchorBack"></a>
			<div class="section">
				<h2 class="sectiontitle">Related tasks</h2>
			</div>
			<p>Read the following section for information about how to apply and use this pattern.</p>
		</div>
		<div>
			<a href="pre.htm">Tasks to complete before applying the pattern</a>
		</div>
		<div>
			<a href="parameters.htm">Parameters for the pattern</a>
		</div>
    </body>
</html>
