<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="copyright" content="Copyright IBM Corporation 2013, 2014"/>
    <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
    <!-- 
    (C) COPYRIGHT International Business Machines Corp., 2013, 2014
    All Rights Reserved * Licensed Materials - Property of IBM
    --> 
    <title>Example messages for C-FIND and C-MOVE requests</title>
</head>
<body role="main">
<h1 class="topictitle1">Example messages for C-FIND and C-MOVE requests</h1> 
<p>Query messages in the 
<span>
Healthcare: Web service to DICOM
</span>
pattern specify their search criteria using DICOM tags. The DICOM standard
defines the tag names, their meaning and permissible values. At each query
root and level, one tag is defined as unique (<b>U</b>). A single value in a 
unique tag uniquely identifies a single entity at that level. That is, two 
entities at the same level do not have the same unique tag value. C-FIND SCPs 
support existence and matching of all unique tags defined by DICOM. All entities 
managed by C-FIND SCPs must have a specific non-zero length unique tag value.</p>

<p>Each DICOM query root and level has a small set of required (<b>R</b>) tags 
which every DICOM vendor must support. Required tags imply the SCP of a C-FIND must 
support matching based on a value contained in a C-FIND request. Multiple entities 
may have the same value for required tags.  That is, a distinct value in a 
required tag does not necessarily identify a single entity at the level of the key. 
C-FIND SCPs support existence and matching of all required tags defined at a given 
root and level. If a C-FIND SCP manages an entity with a tag of zero length, 
the value is considered unknown and all matching against the zero length tag 
is considered a successful match.</p>

<p>There are a much larger set of optional (<b>O</b>) tags which DICOM vendors might 
support. Vendors are free to add additional tags supported in the search criteria. 
Optional tags contained in a C-FIND request may have three different types of 
behaviour depending on support for existence and/or matching by the C-FIND SCP.  
Firstly, if the C-FIND SCP does not support the existence of an optional tag, 
then the tag is not returned in a C-FIND response. Secondly, if the SCP supports 
the existence of an optional tag but does not support matching on the tag, then 
the tag is processed in the same manner as a zero length required tag. That is, 
the value specified to be matched for the tag is ignored but a value may be 
returned by the SCP in the response message. Finally, if the SCP supports the 
existence and matching of the tag, then the tag is processed in the same manner 
as a required tag.</p>

<p>DICOM has many options for describing C-FIND search criteria, particularly 
around wild cards, date and time ranges, and matching multiple values in a list.
Please refer to PS3.4 of the DICOM standard for more information. The
DICOMFindMove node does not currently support matching on sequences. An XML
query message to the DICOMFindMove node may request additional return tags. 
These tags are not used for search criteria in the C-FIND request to the SCP. 
If the return tag is supported by the SCP, response messages contain a 
matching value for each search tag and a value for each return tag.</p>
 
<p>The following example shows an XML query message with two search tags 
of <code>00100010</code> (<code>PatientName</code>) and <code>00080050</code>
(<code>AccessionNumber</code>), and an additional return tag configured of 
<code>00080054</code> (<code>RetrieveAETitle</code>):</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;Match&gt;
        &lt;Attribute Tag="00100010"&gt;FEROVIX&lt;/Attribute&gt;
        &lt;Attribute Tag="00080050"&gt;1210490&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
        &lt;Attribute Tag="00080054"/&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>Query messages can specify their search criteria using the tag name 
(for example, <code>PatientID</code>) or the tag (<code>00100020</code>).
The tag name is generally easier to understand and less error prone than 
using the tag. As shown below, response messages always use the DICOM tag.</p>

<p>The following example shows a DICOM C-FIND results message with the SOAP response envelope removed:</p>
<pre>
&lt;DICOM:Results xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;DICOM&gt;
        &lt;Attribute Tag="00080005" VR="CS"&gt;ISO_IR 100&lt;/Attribute&gt;
        &lt;Attribute Tag="00080016" VR="UI"&gt;1.2.840.10008.5.1.4.1.1.2&lt;/Attribute&gt;
        &lt;Attribute Tag="00080018" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093016410718700003864&lt;/Attribute&gt;
        &lt;Attribute Tag="00080052" VR="CS"&gt;IMAGE&lt;/Attribute&gt;
        &lt;Attribute Tag="00080054" VR="AE"&gt;PACS&lt;/Attribute&gt;
        &lt;Attribute Tag="00080056" VR="CS"&gt;ONLINE&lt;/Attribute&gt;
        &lt;Attribute Tag="0020000D" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093013443132800000021&lt;/Attribute&gt;
        &lt;Attribute Tag="0020000E" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093016410718700003676&lt;/Attribute&gt;
        &lt;Attribute Tag="00200013" VR="IS"&gt;188&lt;/Attribute&gt;
        &lt;Attribute Tag="00880130" VR="SH"/&gt;
        &lt;Attribute Tag="00880140" VR="UI"/&gt;
    &lt;/DICOM&gt;
&lt;/DICOM:Results&gt;
</pre>

<p>The meaning of each DICOM tag in the results message is shown in the table below:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Tag</th>
        <th valign="top" width="*">Name</th>
        <th valign="top" width="*">Value</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080005</td>
            <td valign="top" width="2*">SpecificCharacterSet</td>
            <td valign="top" width="2*">ISO_IR 100</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080016</td>
            <td valign="top" width="2*">SOPClassUID</td>
            <td valign="top" width="2*">1.2.840.10008.5.1.4.1.1.2</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080018</td>
            <td valign="top" width="2*">SOPInstanceUID</td>
            <td valign="top" width="2*">1.3.12.2.1107.5.1.4.54023.30000004093016410718700003864</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080052</td>
            <td valign="top" width="2*">QueryRetrieveLevel</td>
            <td valign="top" width="2*">IMAGE</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080054</td>
            <td valign="top" width="2*">RetrieveAETitle</td>
            <td valign="top" width="2*">PACS</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00080056</td>
            <td valign="top" width="2*">InstanceAvailability</td>
            <td valign="top" width="2*">ONLINE</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">0020000D</td>
            <td valign="top" width="2*">StudyInstanceUID</td>
            <td valign="top" width="2*">1.3.12.2.1107.5.1.4.54023.30000004093013443132800000021</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">0020000E</td>
            <td valign="top" width="2*">SeriesInstanceUID</td>
            <td valign="top" width="2*">1.3.12.2.1107.5.1.4.54023.30000004093016410718700003676</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00200013</td>
            <td valign="top" width="2*">InstanceNumber</td>
            <td valign="top" width="2*">188</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00880130</td>
            <td valign="top" width="2*">StorageMediaFileSetID</td>
            <td valign="top" width="2*"></td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">00880140</td>
            <td valign="top" width="2*">StorageMediaFileSetUID</td>
            <td valign="top" width="2*"></td>
        </tr>
    </tbody>
</table>

<h3>Important!</h3>
<p>Make sure you configure the <code>QueryRoot</code> and <code>QueryLevel</code>
elements correctly in your XML request messages. Use the examples in this topic as a 
reference for each combination of patient root and query level.</p>

<h2>C-MOVE commands</h2>
<p>C-MOVE request messages are set up exactly the same as C-FIND request messages. The 
only difference is the inclusion of a <code>MoveDestination</code> element in the XML 
query message. This move destination is the application entity title where the DICOM 
instances should be moved to using C-STORE commands. The PACS which processes the 
C-FIND and C-MOVE commands must be pre-configured with the connection details of the 
move destination.</p>

<p>The following example shows a DICOM C-FIND and C-MOVE request message with a 
<code>MoveDestination</code> specified:</p>

<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;MoveDestination&gt;REMOTEAE&lt;/MoveDestination&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="PatientID"&gt;fWT0KTL&lt;/Attribute&gt;
        &lt;Attribute Tag="AccessionNumber"&gt;1210490&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The <code>OperationPriority</code> is an optional field in the XML request message.
If is vendor dependent whether the field is honoured or not. The field can take the 
values <code>HIGH</code>, <code>NORMAL</code> or <code>LOW</code>.</p>

<p>SOAP response messages from the pattern are returned after the C-MOVE command 
has completed. The response may therefore take some time if large studies, 
series or images are moved. The response messages also include an XML element
called <code>MoveResults</code> which describes the overall success, or otherwise,
of the C-MOVE command. The detailed status fields in the response message are shown 
below (<code>Completed</code>, <code>Failed</code> and <code>Warnings</code>).</p>

<pre>
&lt;DICOM:Results xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;DICOM&gt;
        &lt;Attribute Tag="00080005" VR="CS"&gt;ISO_IR 100&lt;/Attribute&gt;
        &lt;Attribute Tag="00080016" VR="UI"&gt;1.2.840.10008.5.1.4.1.1.2&lt;/Attribute&gt;
        &lt;Attribute Tag="00080018" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093016410718700003864&lt;/Attribute&gt;
        &lt;Attribute Tag="00080052" VR="CS"&gt;IMAGE&lt;/Attribute&gt;
        &lt;Attribute Tag="00080054" VR="AE"&gt;PACS&lt;/Attribute&gt;
        &lt;Attribute Tag="00080056" VR="CS"&gt;ONLINE&lt;/Attribute&gt;
        &lt;Attribute Tag="0020000D" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093013443132800000021&lt;/Attribute&gt;
        &lt;Attribute Tag="0020000E" VR="UI"&gt;1.3.12.2.1107.5.1.4.54023.30000004093016410718700003676&lt;/Attribute&gt;
        &lt;Attribute Tag="00200013" VR="IS"&gt;188&lt;/Attribute&gt;
        &lt;Attribute Tag="00880130" VR="SH"/&gt;
        &lt;Attribute Tag="00880140" VR="UI"/&gt;
        &lt;MoveResults&gt;
            &lt;Completed&gt;1&lt;/Completed&gt;
            &lt;Failed&gt;0&lt;/Failed&gt;
            &lt;Warnings&gt;0&lt;/Warnings&gt;
        &lt;/MoveResults&gt;
    &lt;/DICOM&gt;
&lt;/DICOM:Results&gt;
</pre>

<h2>Patient root</h2> 

<p>The patient root allows four levels of query: patient, study, series and image.</p>

<h5>Patient root / patient level</h5>
<p>The patient level query is used to query a PACS for patients. It has a small 
number of permissible attributes which can be used in the query, such as the 
patient name, patient sex and birth date.</p>

<p>The following table shows the search tags available for a patient level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientName</td>
            <td valign="top" width="2*">00100010</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientID</td>
            <td valign="top" width="2*">00100020</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">IssuerOfPatientID</td>
            <td valign="top" width="2*">00100021</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientBirthDate</td>
            <td valign="top" width="2*">00100030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientBirthTime</td>
            <td valign="top" width="2*">00100032</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientSex</td>
            <td valign="top" width="2*">00100040</td>
            <td valign="top" width="*">O</td>
        </tr>        
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherPatientIDs</td>
            <td valign="top" width="2*">00101000</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherPatientNames</td>
            <td valign="top" width="2*">00101001</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">EthnicGroup</td>
            <td valign="top" width="2*">00102160</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientComments</td>
            <td valign="top" width="2*">00104000</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedStudies</td>
            <td valign="top" width="2*">00201200</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedSeries</td>
            <td valign="top" width="2*">00201202</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedInstances</td>
            <td valign="top" width="2*">00201204</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows a patient level query with the <code>PatientID</code> (<code>00100020</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;PATIENT&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="00100020"&gt;fWT0KTL&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows a patient level query with <code>PatientBirthDate</code> used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;PATIENT&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="PatientBirthDate"&gt;19670227&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h5>Patient root / study level</h5> 

<p>The study level query is used to query a PACS for the studies for a given patient. 
The study level query must include the patient ID and zero or more optional 
tags to further refine the search, such as the study date.</p>

<p>The following table shows the search tags available for a study level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyDate</td>
            <td valign="top" width="2*">00080020</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyTime</td>
            <td valign="top" width="2*">00080030</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AccessionNumber</td>
            <td valign="top" width="2*">00080050</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyID</td>
            <td valign="top" width="2*">00200010</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyInstanceUID</td>
            <td valign="top" width="2*">0020000D</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ModalitiesInStudy</td>
            <td valign="top" width="2*">00080061</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPClassesInStudy</td>
            <td valign="top" width="2*">00080062</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ReferringPhysicianName</td>
            <td valign="top" width="2*">00080090</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyDescription</td>
            <td valign="top" width="2*">00081030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NameOfPhysicianReadingStudy</td>
            <td valign="top" width="2*">00081060</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ReferringPhysicianName</td>
            <td valign="top" width="2*">00080090</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AdmittingDiagnosesDescription</td>
            <td valign="top" width="2*">00081080</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientAge</td>
            <td valign="top" width="2*">00101010</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientSize</td>
            <td valign="top" width="2*">00101020</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientWeight</td>
            <td valign="top" width="2*">00101030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">Occupation</td>
            <td valign="top" width="2*">00102180</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AdditionalPatientHistory</td>
            <td valign="top" width="2*">001021B0</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherStudyNumbers</td>
            <td valign="top" width="2*">00201070</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfStudyRelatedSeries</td>
            <td valign="top" width="2*">00201206</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfStudyRelatedInstances</td>
            <td valign="top" width="2*">00201208</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows a study level query with the <code>PatientID</code> (<code>00100020</code>) 
and <code>AccessionNumber</code> (<code>00080050</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="00100020"&gt;fWT0KTL&lt;/Attribute&gt;
        &lt;Attribute Tag="00080050"&gt;1210490&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows a study level query with <code>PatientID</code> used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="PatientID"&gt;fWT0KTL&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h5>Patient root / series level</h5> 

<p>The series level query is used to query a PACS for the series within a specific 
study. The series level query must include the study UID and zero or more optional 
attributes to further refine the search, such as the modality.</p>

<p>The following table shows the search tags available for a series level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">Modality</td>
            <td valign="top" width="2*">00080060</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SeriesNumber</td>
            <td valign="top" width="2*">00200011</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SeriesInstanceUID</td>
            <td valign="top" width="2*">0020000E</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfSeriesRelatedInstances</td>
            <td valign="top" width="2*">0020,1209</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows a series level query with the <code>StudyInstanceUID</code> 
(<code>0020000D</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;SERIES&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="0020000D"&gt;1.2.840.113745.101000.1008000.37796.6311.5221360&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows a series level query with <code>StudyInstanceUID</code> 
and <code>Modality</code> used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;SERIES&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="StudyInstanceUID"&gt;1.2.840.113745.101000.1008000.37796.6311.5221360&lt;/Attribute&gt;
        &lt;Attribute Tag="Modality"&gt;CT&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h5>Patient root / image level</h5> 

<p>The image level query is used to query for specific images in a series. It is 
little used. An image level query must include the series UID.</p>

<p>The following table shows the search tags available for an image level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">InstanceNumber</td>
            <td valign="top" width="2*">00200013</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPInstanceUID</td>
            <td valign="top" width="2*">00080018</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPClassUID</td>
            <td valign="top" width="2*">00080016</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">RelatedGeneralSOPClassUID</td>
            <td valign="top" width="2*">0008001A</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ContainerIdentifier</td>
            <td valign="top" width="2*">00400512</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows an image level query with the <code>SeriesInstanceUID</code> 
(<code>0020000E</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;IMAGE&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="0020000E"&gt;1.3.12.2.1107.5.1.4.50146.4.0.2320790629191549&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows an image level query with <code>SeriesInstanceUID</code> 
used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;PATIENT&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;IMAGE&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="SeriesInstanceUID"&gt;1.3.12.2.1107.5.1.4.50146.4.0.2320790629191549&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h2>Study root</h2>
<p>The study root is similar to the patient root, and this similarity often causes confusion. 
There is no patient level query in the study root. The first supported level is the study level 
query. The study level query has a larger set of permissible attributes which can be used. 
Supported search critera include the study date, study time, and also attributes of a patient 
such as the patient name, patient ID and patient sex. This study level query can therefore be 
considered a merging of the study and patient level queries from the patient root.</p>

<p>The study level query is very useful because in one go you can query for all the studies 
of a patient given some basic search criteria like patient name and study date. The patient 
root separates this into two separate queries. </p>

<p>The series level and image level queries are identical in the study root and the patient root.</p>

<h5>Study root / study level</h5> 

<p>The following table shows the search tags available for a study level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyDate</td>
            <td valign="top" width="2*">00080020</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyTime</td>
            <td valign="top" width="2*">00080030</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AccessionNumber</td>
            <td valign="top" width="2*">00080050</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientName</td>
            <td valign="top" width="2*">00100010</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientID</td>
            <td valign="top" width="2*">00100020</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyID</td>
            <td valign="top" width="2*">00200010</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyInstanceUID</td>
            <td valign="top" width="2*">0020000D</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ModalitiesInStudy</td>
            <td valign="top" width="2*">00080061</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPClassesInStudy</td>
            <td valign="top" width="2*">00080062</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ReferringPhysicianName</td>
            <td valign="top" width="2*">00080090</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">StudyDescription</td>
            <td valign="top" width="2*">00081030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NameOfPhysicianReadingStudy</td>
            <td valign="top" width="2*">00081060</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AdmittingDiagnosesDescription</td>
            <td valign="top" width="2*">00081080</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">IssuerOfPatientID</td>
            <td valign="top" width="2*">00100021</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientBirthDate</td>
            <td valign="top" width="2*">00100030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientBirthTime</td>
            <td valign="top" width="2*">00100032</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientSex</td>
            <td valign="top" width="2*">00100040</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherPatientIDs</td>
            <td valign="top" width="2*">00101000</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherPatientNames</td>
            <td valign="top" width="2*">00101001</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientAge</td>
            <td valign="top" width="2*">00101010</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientSize</td>
            <td valign="top" width="2*">00101020</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientWeight</td>
            <td valign="top" width="2*">0010,1030</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">EthnicGroup</td>
            <td valign="top" width="2*">00102160</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">Occupation</td>
            <td valign="top" width="2*">00102180</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">AdditionalPatientHistory</td>
            <td valign="top" width="2*">001021B0</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">PatientComments</td>
            <td valign="top" width="2*">00104000</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">OtherStudyNumbers</td>
            <td valign="top" width="2*">00201070</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedStudies</td>
            <td valign="top" width="2*">00201200</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedSeries</td>
            <td valign="top" width="2*">00201202</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfPatientRelatedInstances</td>
            <td valign="top" width="2*">00201204</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfStudyRelatedSeries</td>
            <td valign="top" width="2*">00201206</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfStudyRelatedInstances</td>
            <td valign="top" width="2*">00201208</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows a study level query with the <code>PatientID</code> 
(<code>00100020</code>) and <code>AccessionNumber</code> (<code>00080050</code>)
used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;Match&gt;
        &lt;Attribute Tag="00100010"&gt;FEROVIX&lt;/Attribute&gt;
        &lt;Attribute Tag="00080050"&gt;1210490&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows a study level query with <code>PatientID</code> 
and <code>AccessionNumber</code> used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;STUDY&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="PatientName"&gt;FEROVIX&lt;/Attribute&gt;
        &lt;Attribute Tag="AccessionNumber"&gt;1210490&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h5>Study root / series level</h5> 

<p>The series level query is used to query a PACS for the series within a specific 
study. The series level query must include the study UID and zero or more optional 
attributes to further refine the search, such as the modality. This level is
exactly the same as the series level in the patient root except the 
<code>QueryRoot</code> in the XML query message is set to <code>STUDY</code> 
instead of <code>PATIENT</code>.</p>

<p>The following table shows the search tags available for a series level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">Modality</td>
            <td valign="top" width="2*">00080060</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SeriesNumber</td>
            <td valign="top" width="2*">00200011</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SeriesInstanceUID</td>
            <td valign="top" width="2*">0020000E</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">NumberOfSeriesRelatedInstances</td>
            <td valign="top" width="2*">0020,1209</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows a series level query with the <code>StudyInstanceUID</code> 
(<code>0020000D</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;SERIES&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="0020000D"&gt;1.2.840.113745.101000.1008000.37796.6311.5221360&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows a series level query with <code>StudyInstanceUID</code> 
and <code>Modality</code> used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;SERIES&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="StudyInstanceUID"&gt;1.2.840.113745.101000.1008000.37796.6311.5221360&lt;/Attribute&gt;
        &lt;Attribute Tag="Modality"&gt;CT&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<h5>Study root / image level</h5>

<p>The image level query is used to query for specific images in a series. It is 
little used. An image level query must include the series UID. This level is
exactly the same as the image level in the patient root except the 
<code>QueryRoot</code> in the XML query message is set to <code>STUDY</code> 
instead of <code>PATIENT</code>.</p>

<p>The following table shows the search tags available for an image level query:</p>
<table summary="" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
    <thead align="left">
    <tr>
        <th class="firstcol" align="left" valign="top" width="*">Name</th>
        <th valign="top" width="*">Tag</th>
        <th valign="top" width="*">Type</th>
    </tr>
    </thead>
    <tbody>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">InstanceNumber</td>
            <td valign="top" width="2*">00200013</td>
            <td valign="top" width="*">R</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPInstanceUID</td>
            <td valign="top" width="2*">00080018</td>
            <td valign="top" width="*">U</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">SOPClassUID</td>
            <td valign="top" width="2*">00080016</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">RelatedGeneralSOPClassUID</td>
            <td valign="top" width="2*">0008001A</td>
            <td valign="top" width="*">O</td>
        </tr>
        <tr>
            <td align="left" valign="top" width="*" class="firstcol">ContainerIdentifier</td>
            <td valign="top" width="2*">00400512</td>
            <td valign="top" width="*">O</td>
        </tr>
    </tbody>
</table>

<p>The following example shows an image level query with the <code>SeriesInstanceUID</code> 
(<code>0020000E</code>) used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;IMAGE&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="0020000E"&gt;1.3.12.2.1107.5.1.4.50146.4.0.2320790629191549&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>The following example shows an image level query with <code>SeriesInstanceUID</code> 
used as the search criteria:</p>
<pre>
&lt;DICOM:FindMove xmlns:DICOM="http://com.ibm.healthcare/DICOM"&gt;
    &lt;QueryRoot&gt;STUDY&lt;/QueryRoot&gt;
    &lt;QueryLevel&gt;IMAGE&lt;/QueryLevel&gt;
    &lt;OperationPriority&gt;NORMAL&lt;/OperationPriority&gt; 
    &lt;Match&gt;
        &lt;Attribute Tag="SeriesInstanceUID"&gt;1.3.12.2.1107.5.1.4.50146.4.0.2320790629191549&lt;/Attribute&gt;
    &lt;/Match&gt;
    &lt;Return&gt;
    &lt;/Return&gt;
&lt;/DICOM:FindMove&gt;
</pre>

<p>
<a href="overview.htm#anchor1" title="Back">Back to the Healthcare: Web service to DICOM pattern specification</a>
</p>
</body>
</html>

