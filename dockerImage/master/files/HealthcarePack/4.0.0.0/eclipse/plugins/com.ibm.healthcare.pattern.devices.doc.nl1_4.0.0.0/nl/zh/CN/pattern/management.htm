<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="copyright" content="Copyright IBM Corporation 2011, 2014"/>
    <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
    <!-- 
        (C) COPYRIGHT International Business Machines Corporation., 2011, 2014
        All Rights Reserved * Licensed Materials - Property of IBM
    --> <title>管理“Healthcare：医疗设备到 EMR”模式实例</title>
</head>
<body role="main">
<a name="links"></a> <h1 class="topictitle1">管理“Healthcare：医疗设备到 EMR”模式实例</h1>
<p>
此模式假设了一个简单的拓扑，其所有消息流都在单个集成节点上运行。本主题提供了有关部署和管理使用这个简单拓扑的模式实例的信息，并提供了有关如何管理此模式实例的信息。
</p>
<p>
本主题包含下列各节：</p>
<div>
    <a href="management.htm#setup">设置</a></div>
<div>
    <a href="management.htm#deployment">模式部署</a></div>
<div>
    <a href="management.htm#errors">监视和错误处理</a></div>
<div class="section">
    <a name="setup"></a> <h2 class="sectiontitle">设置</h2> <h4>队列</h4>
    <p>
    通过在“<span class="uicontrol">配置模式参数</span>”选项卡的“<span class="uicontrol">常规</span>”部分中选中“<span class="msobjpropval">生成脚本</span>”复选框，您可以选择在生成模式实例前生成 MQSC 脚本，用于定义此模式所需的队列。此脚本（名为 <tt>queues.mqsc</tt>）位于模式实例项目的根目录中，用于定义基本队列和主题。</p>
    <p>
    通过使用以下命令，可以运行这个 MQSC 脚本，其中 <var>MBQMGR</var> 是集成节点的队列管理器的名称：</p>
    <pre>runmqsc <var>MBQMGR</var> &lt; queues.mqsc</pre>
    <p>
    您可以编辑此 MQSC 脚本，以添加环境描述以及设置适当的队列深度。其他队列应该受监视并定期进行清除。这些队列以缺省大小进行创建，但您必须复查其使用情况并确保深度足够。</p>
    <p>
    您必须先运行此 MQSC 脚本，然后再部署模式实例。
</p>
</div>
<div class="section">
    <a name="deployment"></a> <h2 class="sectiontitle">模式部署</h2>
    <p>
    在要用于存储这些资源的位置创建一个新 BAR 文件。 </p>
    <p>
    HL7v25P 消息集必须单独打包为一个 BAR 文件：</p>
    <ol>
        <li>
            选择 HL7v25P 消息集，并构建 BAR 文件。</li>
        <li>
            将这个 BAR 文件部署到所有要运行此模式或其中某些部件的集成服务器。</li>
        <li>
            部署 HL7v25P 消息集之后，请确保定义所有的必需队列并部署所有的可配置服务文件。</li>
        <li>
            创建一个或多个 BAR 文件，其中包含要部署到特定集成服务器的流。对于最简单的情况，即所有的项都在单一运行时环境中运行，请包括“接收方”流和“处理方”流。</li>
    </ol>
    <p>
    </p>
</div>
<div class="section">
    <a name="errors"></a> <h2 class="sectiontitle">监视和错误处理</h2>
    <p>
    对于此模式中的所有消息流，错误通知将写入错误队列。另外，还将向模式生成期间定义的位置输出队列跟踪。错误消息的 MQRFH2 头中包含的信息指示了发生错误的位置。本节详细说明了每个消息流的行为的相关详细信息。</p>
    <h3>“医疗设备”流中的错误</h3>
    <p>
    “医疗设备”流作为事务运行，此消息流成功完成时，将落实所有输出消息。
</p>
    <p>
    如果出错，那么将发生下列事件：</p>
    <ul>
        <li>
            错误由 MedicalDevicesExceptionHandler 子流捕获并处理。
            这个子流向消息添加 MQMD 和 MQRFH2 头，并将该消息写入事务外部的错误队列。MQRFH2 头包含关于错误发生位置的详细信息。错误消息的主体包含设备测量。</li>
        <li>
            抛出异常，这将回滚所有消息。此回滚还将触发异常信息输出到事件日志。</li>
        <li>
            当异常回滚至 MedicalDeviceInput 节点时，将废弃设备测量。
</li>
    </ul>
    <p>
    管理员必须监视错误队列和事件日志，以确定模式实例何时未处理消息，并执行必要的补救操作以更正此错误。
</p>
    <h3>“变换并路由”流中的错误</h3>
    <p>
    “变换并路由”流作为单一事务运行。此消息流成功完成时，所有输出消息都将落实到下列位置：</p>
    <ul>
        <li>
            每个目标的“发送方”流的输入队列</li>
        <li>
            规范消息订阅源的队列</li>
    </ul>
    <p>
    如果出错，那么将发生下列事件：</p>
    <ul>
        <li>
            错误由 TransformAndRouteExceptionHandler 子流捕获并处理。这个子流向消息添加 MQRFH2 头，并将该消息写入事务外部的错误队列。MQRFH2 头包含关于错误发生位置的详细信息。</li>
        <li>
            抛出异常，此异常将输入消息放回到队列中，回滚所有写入队列的消息，并触发异常信息输出到事件日志。</li>
    </ul>
    <p>
    </p>
    <p>
    管理员必须检查错误队列和事件日志，以确定发生的错误。错误队列和回退队列都包含信息，并且处理完已更正的消息后必须清除此信息，以避免队列填满。
</p>
    <p>
    管理员必须为输入队列配置回退队列。
</p>
    <h3>“发送方”流中的错误</h3>
    <p>
    一条消息写入事务外部的错误队列，并且输入消息将回滚到“发送方”流的输入队列。
</p>
    <p>
    必须为输入队列配置回退队列。
</p>
    <p>
    另外，交付消息后也可能会发生错误。此类错误在目标应用程序无法处理消息并发送 NACK 时发生。在这种情况下，一条消息将写入错误队列。管理员必须检查此错误消息，并解决目标应用程序中的问题。
</p>
</div>
<a href="overview.htm#anchorBack" title="返回">返回到“Healthcare：医疗设备到 EMR”模式规范</a>
<p>
</p>
</body>
</html>
