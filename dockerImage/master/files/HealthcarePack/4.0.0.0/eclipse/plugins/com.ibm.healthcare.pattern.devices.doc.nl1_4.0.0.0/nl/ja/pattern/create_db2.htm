<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="copyright" content="Copyright IBM Corporation 2011, 2014"/>
    <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
    <title>DB2 のセットアップ</title>
    <!-- 
       (C) COPYRIGHT International Business Machines Corp., 2011, 2014
       All Rights Reserved * Licensed Materials - Property of IBM
      -->
</head>
<body role="main">
<h1>DB2 のセットアップ</h1>
<p>
ここで示す手順では、DB2 Universal Database を使用することを前提に、以下のタスクについて説明します。
</p>
<ul>
    <li>
PATSDB というデータベースを作成します。
</li>
    <li>
DB2 CLI パッケージをバインドします。</li>
    <li>
患者とデバイスとの関連付けを保管する、表 PATIENTS を作成します。
</li>
</ul>
<p>
<b>注</b>: データベース表を作成し、それにアクセスする際には、以下の事項に留意してください。
</p>
<ul>
    <li>
データベースに表を作成するスクリプトを実行するとき、スクリプトを実行する際のユーザー ID によってデータベース・スキーマ名が決まります。
例えば、ユーザー ID が <span class="input">USERID</span> である場合、PATIENTS 表の完全修飾名は USERID.PATIENTS です。
</li>
    <li>
データベースにアクセスするために、データベースおよび表の作成時に使用したのと同じユーザー ID が使用されるようにパターン・インスタンスを構成します。
スキーマ名を構成に含めてください。
例えば、<span class="filepath">Database.USERID.PATIENTS</span> とします。
</li>
</ul>
<p>
以下のステップを実行します。
</p>
<ol>
    <li>
DB2 コマンド・ウィンドウで、以下のコマンドを入力して DB2 が始動するようにします。
<pre>db2start</pre>
    </li>
    <li>
PATSDB というデータベースを作成します。
</li>
    <li>
テキスト・エディターで新しい文書を開き、PATSDB データベースに接続して BIND ユーティリティーを実行する以下のスクリプトをコピーしてその文書に貼り付け、ファイル名を <span class="filepath">PATSDB.sql</span> として、そのファイルを保存します。
<ul>
            <li>
                <p>
<span>Windows</span> の場合:
</p>
install_dir を、ご使用の DB2 製品のインストール・ディレクトリーへのパス (<span class="filepath">C:&#xa5;PROGRA~1&#xa5;IBM&#xa5;SQLLIB</span> など) に置き換える必要があります。
この場所は、db2level コマンドを使って検出できます。
<pre>
CONNECT TO PATSDB
BIND 'install_dir&#xa5;bnd&#xa5;@db2cli.lst' blocking all grant public
TERMINATE
                </pre>
            </li>
            <li>
                <p>
<span>Linux</span> の場合:
</p>
install_dir を、ご使用の DB2 製品のインストール・ディレクトリーへのパスに置き換える必要があります。
この場所は、db2level コマンドを使って検出できます。
<pre>
CONNECT TO PATSDB
BIND install_dir/bnd/@db2cli.lst grant public CLIPKG 5
TERMINATE
                </pre>
            </li>
        </ul>
    </li>
    <li>
DB2 コマンド・ウィンドウで、<span class="filepath">PATSDB.sql</span> が含まれるフォルダーにナビゲートし、以下のコマンドを入力します。
<pre>db2 -vf PATSDB.sql</pre>
    </li>
    <li>
テキスト・エディターで新しい文書を開き、PATIENTS 表を作成する以下のスクリプトをコピーしてその文書に貼り付け、ファイル名を <span class="filepath">patients_create_tables_db2.sql</span> として、そのファイルを保存します。
<pre>
CONNECT TO PATSDB@
DROP TABLE "PATIENTS"@
CREATE TABLE "PATIENTS" (
    "DEVICEID" VARCHAR(50) NOT NULL PRIMARY KEY,
    "PATIENTID" VARCHAR(50)
)
DATA CAPTURE NONE@
TERMINATE@
        </pre>
    </li>
    <li>
データベースが実行されて接続していることを確認します。</li>
    <li>
コマンド・ウィンドウを開いてデータベースにアクセスし、<span class="filepath">patients_create_tables_db2.sql</span> が含まれるフォルダーに移動し、以下のコマンドを実行します。
<pre>db2 -td@ -vf patients_create_tables_db2.sql</pre>
        <p>
スクリプトの実行が終了するまで待ちます。
初めてこのスクリプトを実行する場合には、以下のメッセージが表示されます。
</p>
        <pre>
DB21034E コマンドが、有効なコマンド行プロセッサー・コマンドでないため、SQL ステートメントとして処理されました。
SQL 処理中に、以下の内容が返されました:
SQL0204N  &quot;DB2ADMIN.PATIENTS&quot; は未定義の名前です。SQLSTATE=42704
        </pre>
このメッセージは無視してください。
このメッセージは次の理由で表示されます。
スクリプトによって、既存の表 PATIENTS の除去が、新規表の作成前に試みられますが、これまでスクリプトを実行したことがない場合には、スクリプトでこの既存の表を検出できません。
</li>
</ol>
<p>
</p>
<a href="create.htm" title="戻る">患者 ID データベースのセットアップに戻る</a>
<p>
</p>
</body>
</html>
