<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja-jp" xml:lang="ja-jp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="copyright" content="Copyright IBM Corporation 2011, 2014"/>
    <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
    <!--
    (C) COPYRIGHT International Business Machines Corp., 2011, 2014
    All Rights Reserved * Licensed Materials - Property of IBM
    --> 
    <title>「Healthcare: Medical devices to HL7」パターンの設計</title>
</head>
<body role="main">
<a name="links"></a>
<div class="section">
    <h1 class="topictitle1">「Healthcare: Medical devices to HL7」パターンの設計</h1>
    <p class="shortdesc">
このパターンでは、MedicalDeviceInput ノードを使用して、医療デバイスから測定およびアラートを読み取ります。
デバイス測定内容は、HL7 検査結果メッセージ (ORU R01) に変換されます。
変換済みメッセージは、HL7 MLLP プロトコルを使用して、電子カルテ (EMR) などの宛先アプリケーションに送信されます。
</p>
</div>
<div>
    <p>
このトピックには、以下のセクションが含まれています。
    </p>
    <div>
        <a href="design.htm#devices">医療デバイス・フロー</a></div>
    <div>
        <a href="design.htm#transform">変換および経路指定フロー</a></div>
    <div>
        <a href="design.htm#sender">送信側フロー</a></div>
    <div>
        <a href="design.htm#service">サービス・フロー</a></div>
    <div>
        <a href="design.htm#results">検査結果</a></div>
    <div>
        <a href="design.htm#output">パターン・インスタンスからの出力</a></div>
</div>
<div class="section">
    <a name="devices"></a><h2>医療デバイス・フロー</h2>
    <p>
医療デバイス・フローでは、MedicalDeviceInput ノードからのメッセージを処理します。
各メッセージの MQRFH2 ヘッダーに、有効期限が追加されています。
これらのメッセージは、変換および経路指定フロー用に準備ができているキューに書き込まれます。
このキューにメッセージが書き込まれた後、デバイス測定のジャーナル・メッセージがパブリッシュされます。
</p>
</div>
<div class="section">
    <a name="transform"></a><h2>変換および経路指定フロー</h2>
    <p>
変換および経路指定フローでは、デバイス・メッセージを HL7 検査結果 (ORU R01) に変換します。
このフローでは、各々のデバイス・メッセージを検査して、その測定が有効であることを確認します。
無効な測定は、キューに書き込まれて破棄されます。
患者 ID を参照するようにパターンが構成されている場合には、デバイス ID をデータベース表に対するキーとして使用して、デバイス・メッセージに関連付けられた患者 ID を取得します。
変換済みの HL7 メッセージは、送信側フローのための一致なしキューに書き込まれます。
</p>
</div>
<div class="section">
    <a name="sender"></a><h2>送信側フロー</h2>
    <p>
送信側フローでは、キューから HL7 メッセージを読み取り、HL7 MLLP プロトコルを使用して宛先アプリケーションに送信します。
送信側フローでは、メッセージの送達が中断された場合に、構成可能な回数、再試行します。
送信側フローでは、メッセージの有効期限を検査します。
メッセージの処理に時間がかかりすぎた場合、メッセージは有効期限切れキューに書き込まれた後に破棄されます。
</p>
</div>
<div class="section">
    <a name="service"></a><h2>サービス・フロー</h2>
    <p>
当該パターンでは、オプションで、患者 ID データベースに対する Web サービス・インターフェースを作成することができます。
このインターフェースは、メッセージ・フローを使用して実装します。
Web サービス要求は、SOAPInput ノードを使用して受信されます。
そして、必要なデータベースの照会または更新を実行する計算ノードにルーティングされます。
このフローでは、SOAP ノードを構成するために WSDL メッセージ・セットが必要です。
このメッセージ・セットは、パターン・リソースのトピックにあります。
</p>
</div>
<div class="section">
    <a name="results"></a><h2>検査結果</h2>
    <p>
以下の表では、HL7 ORU R01 メッセージの各セグメントの構成を示します。
</p>
</div>
<div class="tablenoborder">
    <h4>MSH</h4>
    <p>
MSH セグメントは、HL7 メッセージの構文におけるインテント、ソース ID、宛先 ID、およびいくつかの特性を定義します。
</p>
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="33%">フィールド名</th>
            <th class="invisible" valign="top" width="33%">検査結果メッセージ内のフィールド値</th>
            <th class="invisible" valign="top" width="33%">パターン・パラメーターによる構成</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.1.FieldSeparator</th>
            <td valign="top" width="*" class="invisible">
                <span class="msobjpropval">
                '|'
                </span>
            </td>
            <td></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.ServiceString</th>
            <td valign="top" width="*" class="invisible">
                <span class="msobjpropval">
                '^~\&amp;'
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.3.SendingApplication</th>
            <td valign="top" width="*" class="invisible">'Message Broker'</td>
            <td valign="top" width="*" class="invisible">
                <span class="msobjprop">
                ソース ID
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.4.SendingFacility</th>
            <td valign="top" width="*" class="invisible">''</td>
            <td valign="top" width="*" class="invisible">
                <span class="msobjprop">
                ソース・ファシリティー
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.5.ReceivingApplication</th>
            <td valign="top" width="*" class="invisible">'EMR'</td>
            <td>
                <span class="msobjprop">
                宛先 ID
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.6.ReceivingFacility</th>
            <td valign="top" width="*" class="invisible">''</td>
            <td>
                <span class="msobjprop">
                宛先ファシリティー
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.7.DateTimeOfMessage</th>
            <td valign="top" width="*" class="invisible">MedicalDeviceInput ノード・メッセージ内のタイム・スタンプからコピーされる</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.9.MessageType</th>
            <td valign="top" width="*" class="invisible">
                <span class="msobjpropval">
                'ORU^R01^ORU_R01'
                </span>
            </td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.10.MessageControlID</th>
            <td valign="top" width="*" class="invisible">UUID または現行タイム・スタンプ (yyyyMMddHHmmssSSSSSS 形式)</td>
            <td valign="top" width="*" class="invisible">
                <span class="msobjprop">
                メッセージ ID
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.11.ProcessingID</th>
            <td valign="top" width="*" class="invisible">
                <span class="msobjpropval">
                'P'
                </span>
            </td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">MSH.12.VersionID</th>
            <td valign="top" width="*" class="invisible">
                <span class="msobjpropval">
                '2.5'
                </span>
            </td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        </tbody>
    </table>
    <h4>PID</h4>
    <p>
PID セグメントは、患者識別情報をやり取りする主要な方法としてすべてのアプリケーションによって使用されます。
このセグメントには、恒常的でデモグラフィックな患者識別情報が含まれます。
その情報の大部分は、頻繁に変更されないものと考えられます。
</p>
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="33%">フィールド名</th>
            <th class="invisible" valign="top" width="33%">検査結果メッセージ内のフィールド値</th>
            <th class="invisible" valign="top" width="33%">パターン・パラメーターによる構成</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">PID.3.PatientIdentifierList</th>
            <td valign="top" width="*" class="invisible">このフィールドは、<span class="msobjprop">「患者 ID」</span>パターン・パラメーターによって決まります。
<p>
このフィールドは、<span class="msobjpropval">「検査結果に患者 ID がありません」</span>が選択されている場合には評価されません。
</p>
                <p>
<span class="msobjpropval">「デバイスからの患者 ID を使用します」</span>の場合には、メッセージ内の患者 ID がこのフィールドにコピーされます。
</p>
                <p>
<span class="msobjpropval">「データベース内での患者 ID のルックアップ」</span>が選択されている場合には、デバイス ID を使用して、関連付けられた患者 ID をデータベースで検索します。
</p>
            </td>
            <td valign="top" width="*" class="invisible">
                <span class="msobjprop">
                患者 ID
                </span>
            </td>
        </tr>
        </tbody>
    </table>
    <h4>PV1</h4>
    <p>
PV1 セグメントは、アカウントまたは訪問固有のベースで情報をやり取りするために、患者管理アプリケーションによって使用されます。
</p>
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="33%">フィールド名</th>
            <th class="invisible" valign="top" width="33%">検査結果メッセージ内のフィールド値</th>
            <th class="invisible" valign="top" width="33%">パターン・パラメーターによる構成</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">PV1.2.PatientClass</th>
            <td valign="top" width="*" class="invisible">'I'</td>
            <td valign="top" width="*" class="invisible">
                <span class="msobjprop">
                患者クラス
                </span>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">PV1.3.AssignedPatientLocation</th>
            <td valign="top" width="*" class="invisible">MedicalDeviceInput ノード・メッセージからのロケーション</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        </tbody>
    </table>
    <h4>OBR</h4>
    <p>
臨床データの報告で、OBR は結果ヘッダーとして機能します。
以下のアトミック検査によって表される検査セットを特定します。
関連する順序付け情報 (適用時) が含まれます。
含められた検査のすべてに通常適用される属性の多くが入っています。
</p>
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="33%">フィールド名</th>
            <th class="invisible" valign="top" width="33%">検査結果メッセージ内のフィールド値</th>
            <th class="invisible" valign="top" width="33%">パターン・パラメーターによる構成</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBR.7.ObservationDateTime</th>
            <td valign="top" width="*" class="invisible"><span class="msobjprop">MSH.7.DateTimeOfMessage</span> と同じ</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBR.10.CollectorIdentifier</th>
            <td valign="top" width="*" class="invisible"><span class="msobjprop">PV1.3.AssignedPatientLocation</span> と同じ</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        </tbody>
    </table>
    <h4>OBX</h4>
    <p>
OBX セグメントは、単一の検査または検査フラグメントを送信するために使用します。
分割できない、結果の最小単位を表します。
</p>
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="33%">フィールド名</th>
            <th class="invisible" valign="top" width="33%">検査結果メッセージ内のフィールド値</th>
            <th class="invisible" valign="top" width="33%">パターン・パラメーターによる構成</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.1.SetIDOBX</th>
            <td valign="top" width="*" class="invisible">1 から始まる、OBX セグメントの数値インデックス。</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.2.ValueType</th>
            <td valign="top" width="*" class="invisible">'ST'</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.3.ObservationIdentifier</th>
            <td valign="top" width="*" class="invisible">MedicalDeviceInput ノード・メッセージからの 1 次 ID および 2 次 ID と、測定タイプの簡略説明。</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.5.ObservationValue</th>
            <td valign="top" width="*" class="invisible">MedicalDeviceInput ノード・メッセージからの値。</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.6.Units</th>
            <td valign="top" width="*" class="invisible">MedicalDeviceInput ノード・メッセージからの単位。</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.11.ObservationResultStatus</th>
            <td valign="top" width="*" class="invisible">'F'</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">OBX.14.DateTimeoftheObservation</th>
            <td valign="top" width="*" class="invisible"><span class="msobjprop">MSH.7.DateTimeOfMessage</span> と同じ</td>
            <td valign="top" width="*" class="invisible"></td>
        </tr>
        </tbody>
    </table>
    <p>
当該パターンでは、波形メッセージの場合、複数の測定を入れることができるため、複数の OBX セグメントが作成されます。
</p>
</div>
<div class="section">
    <a name="output"></a><h2>パターン・インスタンスからの出力</h2>
    <p>
当該パターンは、宛先アプリケーションにルーティングされる HL7 メッセージに加えて、他の多くの出力を提供します。
これらの出力は、キューに書き込まれるか、または Publication ノードに送信されます。
宛先は、パターン・パラメーター<span class="msobjprop">「パブリッシュ」</span>によって決まります。<span class="msobjpropval">「パブリッシュ」</span>オプションが選択されている場合は、パターン・インスタンス名で始まるトピック階層を使用することにより、すべての情報がパブリッシュされます。
    </p>
    <p>
<span class="msobjpropval">「キューへの書き込み」</span>オプションが選択されている場合は、パターン・パラメーター<span class="msobjprop">「キュー接頭部」</span>と固定の接尾部セット (次の表に記載します) から生成される名前のキューに出力が送信されます。
</p>
    <p>
    <b>注</b>: 各トピックの最初のファセット (パターン・インスタンス名) は示されていません。
</p>
</div>
<div class="tablenoborder">
    <table summary="" width="100%" border="1" cellpadding="4" cellspacing="0" frame="border" rules="all">
        <thead align="left">
        <tr>
            <th class="firstcol" align="left" valign="top" width="20%">出力</th>
            <th class="invisible" valign="top" width="15%">キュー接尾部
</th>
            <th class="invisible" valign="top" width="15%">トピック</th>
            <th valign="top" width="50%">注</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">ジャーナル</th>
            <td valign="top" width="*" class="invisible">.JRNL</td>
            <td valign="top" width="*" class="invisible">/Journal</td>
            <td valign="top" width="*" class="invisible">この出力は、着信メッセージのジャーナルを標準パターン形式で提供します。
<p>
注 1 を参照。</p>
            </td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">変換および経路指定</th>
            <td valign="top" width="*" class="invisible">.RXF</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">各メッセージは、変換および経路指定フローに送信されます。</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">エラーのあるメッセージ</th>
            <td valign="top" width="*" class="invisible">.ERR</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">正しく処理できなかったメッセージが、MQRFH2 ヘッダーにエラー情報を入れてエラー・キューに書き込まれます。
</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">正規</th>
            <td valign="top" width="*" class="invisible">.CAN</td>
            <td valign="top" width="*" class="invisible">/Canonical</td>
            <td valign="top" width="*" class="invisible">正規フィードを出力するオプションが選択されている場合は、入力メッセージの正規 HL7 形式が書き込まれます。</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">送信側へ</th>
            <td valign="top" width="*" class="invisible">.DEST</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">各メッセージは、HL7 に変換された後、送信側フローに送信されます。</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">有効期限が切れたメッセージ</th>
            <td valign="top" width="*" class="invisible">.EXP</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">構成された有効期限を越えたメッセージは、このキューに書き込まれます。</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">サービス・ログ</th>
            <td valign="top" width="*" class="invisible">.LOG</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">患者 ID Web サービスにおける、すべての SOAP 要求および応答メッセージのコピーを保管します。</td>
        </tr>
        <tr>
            <th align="left" valign="top" width="*" class="firstcol">患者 ID の一致なし</th>
            <td valign="top" width="*" class="invisible">.NOMATCH</td>
            <td valign="top" width="*" class="invisible">適用外</td>
            <td valign="top" width="*" class="invisible">一致する患者 ID がないメッセージは、このキューに書き込まれます。</td>
        </tr>
        </tbody>
    </table>
    <p>
    <b>注 1:</b> ジャーナル・メッセージは、ソース・メッセージに MQMD ヘッダーおよび MQRFH2 ヘッダーを追加することによって生成されます。
MQRFH2 ヘッダーには、以下のものが含まれています。
</p>
    <ul>
        <li>
Integration ノード名
</li>
        <li>
メッセージ・フロー
</li>
        <li>
現在のタイム・スタンプ
</li>
    </ul>
</div>
<p>
</p>
<a href="overview.htm#anchorBack" title="戻る">「Healthcare: Medical devices to EMR」パターンの仕様に戻る</a>
<p>
</p>
</body>
</html>
