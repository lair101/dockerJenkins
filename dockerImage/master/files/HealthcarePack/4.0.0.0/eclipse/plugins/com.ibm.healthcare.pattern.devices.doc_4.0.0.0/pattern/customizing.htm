<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="copyright" content="Copyright IBM Corporation 2011, 2014"/>
    <link rel="stylesheet" type="text/css" href="./css/pattern.css"/>
    <!-- 
        (C) COPYRIGHT International Business Machines Corporation., 2011, 2014
        All Rights Reserved * Licensed Materials - Property of IBM
    --> <title>Customizing a Healthcare: HL7 to Reports pattern instance</title>
</head>
<body role="main">
<a name="links"></a> <h1 class="topictitle1">Customizing a Healthcare: Medical 
devices to EMR pattern instance</h1>
<div class="section">
    <a name="customize"></a> <h2 class="sectiontitle">Customization subflows</h2>
    <p>
    Ten main customization points are available to users of the pattern. These 
    subflows are invoked at various stages of processing as device messages are 
    propagated by the MedicalDeviceInput node, transformed to HL7 and delivered to the EMR. 
    The most common requirement is to customize the HL7 observation result message, 
    this is best achieved by changing the <tt>OnDestination</tt> subflow.
    </p>
    <h3>Medical Devices flow</h3> 
    <div class="image">
        <img src="devices.png" alt="A diagram showing the Medical Devices flow" />
    </div>
    <h4>Status customization</h4>
    <p>
    The <tt>OnStatus</tt> subflow is invoked when a status message is propagated 
    from the MedicalDeviceInput node. Status messages contain device status information, 
    warnings and errors. An example of an error message is the MedicalDeviceInput node 
    reporting that it cannot connect to a medical device. A common use of this 
    subflow is to send an alert if a medical device reports an error condition.
    </p>
    <h3>Transform and Route flow</h3> 
    <div class="image">
        <img src="transform.png" alt="A diagram showing the Transform and Route flow" />
    </div>
    <h4>Invalid measurement customization</h4>
    <p>
    The <tt>OnInvalid</tt> subflow is invoked if a device measurement is propagated 
    with a validity other than
    <span class="msobjpropval">
    CM_VALID
    </span>
    . The validity element in the device message provides a confidence in the 
    measurement from the medical device. The pattern only transforms and delivers 
    valid device messages.
    </p>
    <h4>No match customization</h4>
    <p>
    The <tt>OnNoMatch</tt> subflow is invoked when a device message is processed 
    which has no patient identifier. This subflow is only invoked if the
    <span class="msobjprop">
    Patient identifiers
    </span>
    pattern parameter is set to something other than
    <span class="msobjpropval">
    No patient identifiers in observation results
    </span>
    . It is not necessarily an error condition to have device messages which do not 
    have an associated patient identifier. For example, a device can be left 
    switched on and continues to generate device messages, but the patient 
    association may have been removed from the database.
    </p>
    <h4>Measure customization</h4>
    <p>
    The <tt>OnMeasure</tt> subflow is invoked for every device measurement 
    propagated by the MedicalDeviceInput node. This subflow is invoked before the device 
    message is transformed to HL7 so it contains the unchanged measurement from the 
    MedicalDeviceInput node. One use of this subflow is to adjust the
    <span class="msobjprop">
    PrimaryId
    </span>
    in the message to be the correct code for the EMR (for example, a LOINC code).
    </p>
    <h3>Sender flow</h3> 
    <div class="image">
        <img src="sender.png" alt="A diagram showing the Sender flow" />
    </div>
    <h4>Destination customization</h4>
    <p>
    The <tt>OnDestination</tt> subflow is invoked after the device message has been 
    transformed to HL7. After this subflow is invoked, the message is written to the 
    destination queue ready to be delivered to the EMR. This subflow is commonly 
    used to customize the HL7 observation result message for any site-specific 
    message requirements.
    </p>
    <h4>Expired customization</h4>
    <p>
    The
    <span class="msobjprop">
    Expiry time
    </span>
    pattern parameter ensures that aged messages are not delivered to the EMR. The 
    expiry check is done just before the transformed HL7 message is sent to the 
    destination application. Expired messages are written to an expiry queue and 
    discarded. This subflow is invoked with the transformed HL7 message before it is 
    written to the expiry queue.
    </p>
    <h4>Finished customization</h4>
    <p>
    The <tt>OnFinished</tt> subflow is invoked after a transformed HL7 message is 
    delivered and acknowledged by the destination application.
    </p>
    <h4>Sender customization</h4>
    <p>
    The <tt>OnSend</tt> subflow is invoked prior to the transformed HL7 message 
    being sent to the destination HL7 application. The subflow provides an 
    opportunity to make any final changes before the HL7 message is sent to the EMR.
    </p>
    <h3>Web Services flow</h3> 
    <div class="image">
        <img src="service.png" alt="A diagram showing the Web Services flow" />
    </div>
    <h4>Service customization</h4>
    <p>
    The pattern provides a web service to manage the patient identifiers database. 
    The <tt>OnService</tt> subflow is invoked for every request to this web service.
    </p>
    <h3>Error handling</h3> 
    <p>
    Each main flow in the pattern has its own error handling subflow. 
    Error messages are written to a common error queue across the pattern. 
    </p>
    <h4>Error customization</h4>
    <p>
    The <tt>OnErrorQueue</tt> is called when an error has been detected and an error 
    message is written to the error queue. The default customization subflow has no 
    effect on the message, but you can use this subflow to build an error message 
    that matches the specifications required by your environment.
    </p>
</div>
<a href="overview.htm#anchorBack" title="Back">Back to the Healthcare: Medical 
devices to EMR pattern specification</a>
<p>
</p>
</body>
</html>
